<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Race Details | Why Racing Events</title>
    <meta name="description" id="pageDescription" content="Join us for an amazing race experience!">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Oswald:wght@500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --brand-red: #E31837;
            --brand-blue: #000000;
            --primary: #E31837;
            --primary-dark: #b91429;
            --dark: #0a0a0a;
            --light: #ffffff;
            --grey: #f4f4f4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light);
            color: #333;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: 'Oswald', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80vh;
            text-align: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #eee;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 1.2rem;
            color: #666;
        }

        nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 15px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: linear-gradient(90deg, rgba(0, 0, 0, 0.35) 0%, rgba(227, 24, 55, 0.35) 100%);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .logo {
            text-decoration: none;
            padding: 5px 0;
        }

        .logo img {
            height: 40px;
            filter: brightness(0) invert(1);
        }

        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .nav-links a {
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            color: white;
            letter-spacing: 1px;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-btn {
            background: white;
            color: var(--primary);
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 12px;
        }

        .event-hero {
            height: 60vh;
            min-height: 400px;
            background: linear-gradient(135deg, rgba(227, 24, 55, 0.4) 0%, rgba(0, 0, 0, 0.3) 100%), url('../../images/action/hagg-lake-run.jpg') center/cover;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 100px 20px 60px;
            position: relative;
            overflow: hidden;
        }

        #heroBackground {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }

        #heroOverlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(227, 24, 55, 0.4) 0%, rgba(0, 0, 0, 0.3) 100%);
            z-index: 1;
        }

        .event-hero-content {
            position: relative;
            z-index: 2;
        }

        .event-hero-content .event-tag {
            background: var(--primary);
            padding: 8px 16px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 15px;
        }

        .event-hero-content h1 {
            font-size: 3.5rem;
            font-style: italic;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .event-hero-content .event-date {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .event-hero-content .event-location {
            font-size: 1.1rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .hero-cta {
            display: inline-block;
            background: white;
            color: var(--primary);
            padding: 16px 36px;
            font-weight: 700;
            text-transform: uppercase;
            border-radius: 4px;
            font-size: 15px;
            transition: 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .hero-cta:hover {
            background: var(--grey);
            transform: translateY(-2px);
        }

        .info-banner {
            background: var(--grey);
            padding: 20px 5%;
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            border-bottom: 3px solid var(--primary);
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .info-item i {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .event-details {
            max-width: 1100px;
            margin: 0 auto;
            padding: 60px 5%;
            display: grid;
            grid-template-columns: 1.8fr 1fr;
            gap: 50px;
        }

        .event-info h2 {
            font-size: 1.8rem;
            color: var(--brand-blue);
            font-style: italic;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary);
            padding-left: 15px;
        }

        .event-info p {
            font-size: 1.05rem;
            line-height: 1.8;
            color: #555;
            margin-bottom: 20px;
        }

        #includedList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            list-style: none;
            margin-bottom: 30px;
        }

        #includedList li {
            background: var(--grey);
            padding: 12px 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        #includedList li i {
            color: var(--primary);
            width: 20px;
            text-align: center;
        }

        .distances {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .logistics-bar {
            background: var(--grey);
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid var(--primary);
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 15px;
        }

        .logistics-item {
            flex: 1;
            min-width: 150px;
        }

        .logistics-label {
            display: block;
            font-size: 11px;
            font-weight: 700;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }

        .logistics-value {
            display: block;
            font-weight: 700;
            color: var(--brand-blue);
            font-size: 14px;
            line-height: 1.4;
        }

        .distance-tag {
            background: var(--grey);
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 700;
            color: var(--brand-blue);
            border-left: 4px solid var(--primary);
        }

        .register-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 100px;
            border-top: 5px solid var(--primary);
        }

        .register-card h3 {
            font-size: 1.3rem;
            color: var(--brand-blue);
            margin-bottom: 20px;
            font-style: italic;
            text-align: center;
        }

        .register-btn {
            width: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 18px;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
            letter-spacing: 1px;
        }

        .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(227, 24, 55, 0.4);
        }

        .register-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .race-info-list {
            margin: 20px 0;
        }

        .race-info-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .race-info-label {
            color: #666;
        }

        .race-info-value {
            font-weight: 700;
            color: var(--brand-blue);
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 30px;
            transition: 0.3s;
        }

        .back-link:hover {
            gap: 12px;
        }

        footer {
            background: #111;
            color: rgba(255, 255, 255, 0.35);
            padding: 50px 5%;
            text-align: center;
        }

        .footer-brand {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 10px;
        }

        .footer-brand span {
            color: var(--primary);
        }

        .footer-copy {
            font-size: 13px;
            opacity: 0.7;
        }

        @media (max-width: 900px) {
            .event-hero-content h1 {
                font-size: 2.5rem;
            }

            .event-details {
                grid-template-columns: 1fr;
            }

            .register-card {
                position: static;
            }

            .nav-links {
                display: none;
            }

            .info-banner {
                gap: 20px;
            }
        }

        /* Accordion Styles */
        .accordion-container {
            margin-top: 40px;
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .accordion-section {
            border-bottom: 1px solid #eee;
        }

        .accordion-section:last-child {
            border-bottom: none;
        }

        .accordion-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            background: white;
            border: none;
            cursor: pointer;
            font-family: 'Oswald', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--brand-blue);
            text-align: left;
            transition: background 0.2s;
        }

        .accordion-header:hover {
            background: #f9f9f9;
        }

        .accordion-header i {
            transition: transform 0.3s;
            color: var(--primary);
        }

        .accordion-header.active i {
            transform: rotate(180deg);
        }

        .accordion-content {
            display: none;
            padding: 0 24px 24px;
            animation: fadeIn 0.3s ease;
        }

        .accordion-content.show {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Content Cards */
        .content-card {
            background: var(--grey);
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary);
        }

        .content-card h4 {
            font-size: 1rem;
            margin-bottom: 8px;
            color: var(--brand-blue);
        }

        .content-card p {
            font-size: 0.9rem;
            color: #555;
            line-height: 1.6;
        }

        /* FAQ Styles */
        .faq-item {
            background: var(--grey);
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .faq-question {
            padding: 16px 20px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }

        .faq-question:hover {
            background: #e8e8e8;
        }

        .faq-answer {
            display: none;
            padding: 0 20px 16px;
            color: #555;
            line-height: 1.7;
        }

        .faq-answer.show {
            display: block;
        }

        /* Policy Badge */
        .policy-badge {
            display: inline-block;
            background: #e8e8e8;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 4px;
        }

        /* Sponsor Grid */
        .sponsor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .sponsor-logo {
            background: white;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-height: 80px;
        }

        .sponsor-logo img {
            max-width: 100%;
            max-height: 60px;
            object-fit: contain;
        }

        /* Beneficiary Card */
        .beneficiary-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 24px;
            border-radius: 12px;
            border-left: 4px solid #f59e0b;
            margin-bottom: 16px;
        }

        .beneficiary-card h4 {
            color: #92400e;
            margin-bottom: 8px;
        }

        .beneficiary-card p {
            color: #78350f;
        }

        /* Pickup Location */
        .pickup-card {
            background: var(--grey);
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 12px;
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 16px;
            align-items: start;
        }

        .pickup-date {
            background: var(--primary);
            color: white;
            padding: 10px 14px;
            border-radius: 8px;
            text-align: center;
            min-width: 65px;
        }

        .pickup-date .day {
            font-size: 1.4rem;
            font-weight: 700;
            line-height: 1;
        }

        .pickup-date .month {
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        /* Award Category Tags */
        .award-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .award-tag {
            background: #e8e8e8;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
    </style>
</head>

<body>

    <nav>
        <a href="../../index.html" class="logo"><img src="../../attached_assets/why-racing-logo_1767589311719.png"
                alt="Why Racing Events"></a>
        <div class="nav-links">
            <a href="../events.html">Races</a>
            <a href="../volunteers.html">Volunteer</a>
            <a href="../community.html">Community</a>
            <a href="../partners.html">Sponsors</a>
        </div>
        <a href="#register" class="nav-btn" id="navRegisterBtn">Register Now</a>
    </nav>

    <!-- Loading State -->
    <div class="loading-container" id="loadingState">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading race details...</div>
    </div>

    <!-- Main Content (hidden until loaded) -->
    <div id="mainContent" style="display: none;">
        <div class="event-hero">
            <div id="heroBackground"></div>
            <div id="heroOverlay"></div>
            <div class="event-hero-content">
                <div id="raceLogoContainer" style="display: none; margin-bottom: 20px;">
                    <img id="raceLogo" src="" alt="Race Logo"
                        style="max-height: 120px; max-width: 280px; object-fit: contain; margin-bottom: 20px;">
                </div>
                <span class="event-tag" id="raceType">üèÉ Race</span>
                <div class="event-date" id="raceDate">üìÖ Date TBD</div>
                <h1 id="raceName">Race Name</h1>
                <div class="event-location">
                    <i class="fas fa-map-marker-alt"></i>
                    <span id="raceLocation">Location TBD</span>
                </div>
                <a href="#register" class="hero-cta" id="heroCta">Secure My Spot</a>
            </div>
        </div>

        <div class="info-banner" id="infoBanner">
            <div class="info-item" id="infoTime" style="display: none;">
                <i class="fas fa-clock"></i>
                <span id="raceTime">8:00 AM</span>
            </div>
            <div class="info-item" id="infoVenue" style="display: none;">
                <i class="fas fa-location-dot"></i>
                <span id="raceVenue">Venue</span>
            </div>
            <div class="info-item">
                <i class="fas fa-running"></i>
                <span id="raceDistances">5K / 10K</span>
            </div>
        </div>

        <section class="event-details">
            <div class="event-info">
                <a href="../events.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to All Events</a>

                <h2>üìã About This Race</h2>
                <p id="raceDescription">Join us for an amazing race experience! More details coming soon.</p>

                <div id="distancesSection">
                    <h3 style="margin-top: 30px; margin-bottom: 15px; color: var(--brand-blue); font-style: italic;">üèÉ
                        Available Distances</h3>
                    <div class="distances" id="distancesList">
                        <!-- Distances will be loaded here -->
                    </div>
                </div>

                <div id="includedSection" style="display: none;">
                    <h3 style="margin-top: 30px; margin-bottom: 15px; color: var(--brand-blue); font-style: italic;">üéÅ
                        What's Included</h3>
                    <ul id="includedList">
                        <!-- Will be populated from database -->
                    </ul>
                </div>

                <!-- YouTube Video Section -->
                <div id="videoSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 15px; color: var(--brand-blue); font-style: italic;">üé¨ Race Video</h3>
                    <div id="videoContainer"
                        style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                        <iframe id="youtubeEmbed"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" frameborder="0"
                            allowfullscreen></iframe>
                    </div>
                </div>

                <!-- Course Details Section -->
                <div id="courseSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 15px; color: var(--brand-blue); font-style: italic;">üó∫Ô∏è Course Details
                    </h3>
                    <div style="background: var(--grey); padding: 20px; border-radius: 8px;">
                        <div id="courseDetails"></div>
                    </div>
                </div>

                <!-- Event Logistics Bar -->
                <div id="logisticsSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 15px; color: var(--brand-blue); font-style: italic;">üìã Event Logistics
                    </h3>
                    <div class="logistics-bar">
                        <div id="aidSection" class="logistics-item" style="display: none;">
                            <span class="logistics-label">ü•§ Aid Stations</span>
                            <span id="aidInfo" class="logistics-value"></span>
                        </div>
                        <div id="parkingSection" class="logistics-item" style="display: none;">
                            <span class="logistics-label">üÖøÔ∏è Parking</span>
                            <span id="parkingInfo" class="logistics-value"></span>
                        </div>
                        <div id="packetSection" class="logistics-item" style="display: none;">
                            <span class="logistics-label">üì¶ Packet Pickup</span>
                            <span id="packetInfo" class="logistics-value"></span>
                        </div>
                    </div>
                </div>

                <!-- Charity Section -->
                <div id="charitySection"
                    style="display: none; margin-top: 40px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 25px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                    <h3 style="margin-bottom: 10px; color: #92400e; font-style: italic;">‚ù§Ô∏è Supporting a Good Cause</h3>
                    <p id="charityName" style="font-weight: 700; font-size: 1.1rem; color: #78350f;"></p>
                    <p id="charityDesc" style="color: #92400e; margin-top: 8px;"></p>
                </div>

                <!-- Video Highlights Section -->
                <div id="videoSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 20px; color: var(--brand-blue); font-style: italic;">üé¨ Race Highlights
                    </h3>
                    <div
                        style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);">
                        <iframe id="videoFrame"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
                            allowfullscreen
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
                    </div>
                </div>

                <!-- Gallery Section -->
                <div id="gallerySection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 20px; color: var(--brand-blue); font-style: italic;">üì∏ Race Gallery</h3>
                    <div id="galleryGrid"
                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <!-- Gallery images will be loaded here -->
                    </div>
                </div>

                <!-- ACCORDION SECTIONS -->
                <div class="accordion-container" id="accordionSections">

                    <!-- Packet Pickup Section -->
                    <div class="accordion-section" id="pickupAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            üì¶ Packet Pickup Locations
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="pickupContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- FAQs Section -->
                    <div class="accordion-section" id="faqAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            ‚ùì Frequently Asked Questions
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="faqContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Policies Section -->
                    <div class="accordion-section" id="policiesAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            üìã Rules & Policies
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="policiesContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Awards Section -->
                    <div class="accordion-section" id="awardsAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            üèÜ Awards & Age Groups
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="awardsContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Travel Section -->
                    <div class="accordion-section" id="travelAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            ‚úàÔ∏è Travel & Accommodations
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="travelContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Spectator Section -->
                    <div class="accordion-section" id="spectatorAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            üëÄ Spectator Guide
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="spectatorContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Multi-Sport Section (conditionally shown) -->
                    <div class="accordion-section" id="multisportAccordion" style="display: none;">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            üèä Multi-Sport Details
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="accordion-content" id="multisportContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                </div>

                <!-- Beneficiaries Section (Always Visible) -->
                <div id="beneficiariesSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 20px; color: var(--brand-blue); font-style: italic;">‚ù§Ô∏è Supporting Great
                        Causes</h3>
                    <div id="beneficiariesList">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Sponsors Section (Always Visible) -->
                <div id="sponsorsSection" style="display: none; margin-top: 40px;">
                    <h3 style="margin-bottom: 20px; color: var(--brand-blue); font-style: italic;">ü§ù Our Partners &
                        Sponsors</h3>
                    <div id="sponsorsList">
                        <!-- Populated by JS -->
                    </div>
                </div>

            </div>

            <div id="register" class="registration-sidebar">
                <div class="register-card">
                    <h3>üèÉ Register Now</h3>

                    <div class="race-info-list">
                        <div class="race-info-item">
                            <span class="race-info-label">Date</span>
                            <span class="race-info-value" id="cardDate">TBD</span>
                        </div>
                        <div class="race-info-item" id="cardTimeRow" style="display: none;">
                            <span class="race-info-label">Start Time</span>
                            <span class="race-info-value" id="cardTime">TBD</span>
                        </div>
                        <div class="race-info-item">
                            <span class="race-info-label">Location</span>
                            <span class="race-info-value" id="cardLocation">TBD</span>
                        </div>
                        <div class="race-info-item" id="pdfLinkRow" style="display: none;">
                            <span class="race-info-label">Instructions</span>
                            <span class="race-info-value"><a href="#" id="pdfLink" target="_blank"
                                    style="color: var(--primary); font-weight: 700;">üìÑ Pre-Race (PDF)</a></span>
                        </div>
                    </div>

                    <button class="register-btn" id="registerBtn" onclick="handleRegister()">
                        Register Now
                    </button>

                    <p id="regStatus" style="text-align: center; margin-top: 15px; font-size: 13px; color: #666;"></p>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <div class="footer-brand">WHY<span>RACING</span></div>
        <div class="footer-copy">&copy; 2026 Why Racing Events Inc. | La Center, WA | (360) 314-4682</div>
        <div style="margin-top: 15px; opacity: 0.3; font-size: 10px; text-align: center;">
            <a href="../admin/races.html" style="color: white; text-decoration: none;">Staff Portal</a>
        </div>
    </footer>

    <script>
        let currentRace = null;

        // Get race ID from URL
        function getRaceId() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        // Format date
        function formatDate(dateString) {
            if (!dateString) return 'TBD';
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('en-US', {
                weekday: 'long',
                month: 'long',
                day: 'numeric',
                year: 'numeric'
            });
        }

        // Format time
        function formatTime(timeString) {
            if (!timeString) return null;
            // Handle both HH:MM:SS and HH:MM
            const parts = timeString.split(':');
            const h = parseInt(parts[0]);
            const m = parts[1];
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return `${h12}:${m} ${ampm}`;
        }

        // Get race type label
        function getRaceTypeLabel(type) {
            const types = {
                'run': 'üèÉ Road Race',
                'running': 'üèÉ Road Race',
                'trail': 'üå≤ Trail Run',
                'triathlon': 'üèä Triathlon',
                'ultra': 'üèîÔ∏è Ultra',
                'fun_run': 'üéâ Fun Run',
                'kids': 'üë∂ Kids Race',
                'virtual': 'üíª Virtual'
            };
            return types[type] || 'üèÉ Race';
        }

        // Extract YouTube video ID from URL
        function extractYouTubeId(url) {
            if (!url) return null;
            const patterns = [
                /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,
                /youtube\.com\/v\/([^&\n?#]+)/
            ];
            for (const pattern of patterns) {
                const match = url.match(pattern);
                if (match && match[1]) return match[1];
            }
            return null;
        }

        // Handle registration click
        function handleRegister() {
            if (!currentRace) return;

            if (currentRace.registration_url) {
                window.open(currentRace.registration_url, '_blank');
            } else if (currentRace.registration_open) {
                alert('Online registration is being set up. Please check back soon or contact info@whyracingevents.com');
            } else {
                alert('Registration is not yet open. Please check back later!');
            }
        }

        // Load race data
        async function loadRace() {
            const raceId = getRaceId();

            if (!raceId) {
                document.getElementById('loadingState').innerHTML = `
                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #e74c3c; margin-bottom: 20px;"></i>
                <h2>Race Not Found</h2>
                <p style="margin-top: 15px;"><a href="../events.html" style="color: var(--primary);">‚Üê Back to All Events</a></p>
            `;
                return;
            }

            try {
                const response = await fetch(`/api/races/${raceId}/full`);
                if (!response.ok) throw new Error('Race not found');

                const race = await response.json();
                currentRace = race;

                // Update page title
                document.getElementById('pageTitle').textContent = `${race.name} | Why Racing Events`;
                document.getElementById('pageDescription').content = race.description || 'Join us for an amazing race!';

                // Update hero
                if (race.hero_image_url) {
                    document.getElementById('heroBackground').style.backgroundImage = `url('${race.hero_image_url}')`;
                }
                document.getElementById('raceType').textContent = getRaceTypeLabel(race.race_type);
                document.getElementById('raceDate').textContent = 'üìÖ ' + formatDate(race.race_date);
                document.getElementById('raceName').textContent = race.name || 'Race';
                document.getElementById('raceLocation').textContent = `${race.city || 'TBA'}${race.state ? ', ' + race.state : ''}`;

                // Update info banner
                if (race.race_time) {
                    document.getElementById('infoTime').style.display = 'flex';
                    document.getElementById('raceTime').textContent = formatTime(race.race_time);
                }
                if (race.venue) {
                    document.getElementById('infoVenue').style.display = 'flex';
                    document.getElementById('raceVenue').textContent = race.venue;
                }

                // Update distances
                const distances = race.race_distances || [];
                if (distances.length > 0) {
                    document.getElementById('distancesList').innerHTML = distances.map(d => {
                        const time = d.start_time ? `<span style="display: block; font-size: 0.8rem; margin-top: 4px; opacity: 0.8;">Starts ${formatTime(d.start_time)}</span>` : '';
                        return `<div class="distance-tag" style="display: block; padding: 12px 20px;">
                            ${d.name || d.distance_value}
                            ${time}
                        </div>`;
                    }).join('');
                    document.getElementById('raceDistances').textContent = distances.map(d => d.name || d.distance_value).join(' / ');
                } else {
                    document.getElementById('raceDistances').textContent = 'Details TBA';
                }

                // Update description
                document.getElementById('raceDescription').textContent = race.description || 'More details coming soon! Check back later for full race information.';

                // Update card
                document.getElementById('cardDate').textContent = formatDate(race.race_date);
                document.getElementById('cardLocation').textContent = `${race.city || 'TBA'}${race.state ? ', ' + race.state : ''}`;
                if (race.race_time) {
                    document.getElementById('cardTimeRow').style.display = 'flex';
                    document.getElementById('cardTime').textContent = formatTime(race.race_time);
                }

                // Handle PDF Instructions
                if (race.instructions_pdf_url) {
                    document.getElementById('pdfLinkRow').style.display = 'flex';
                    document.getElementById('pdfLink').href = race.instructions_pdf_url;
                }

                // Update registration button
                const regBtn = document.getElementById('registerBtn');
                const regStatus = document.getElementById('regStatus');

                if (race.registration_url) {
                    regBtn.textContent = 'üèÉ Register Now';
                    regStatus.textContent = 'Secure checkout via RunSignUp';
                } else if (race.registration_open) {
                    regBtn.textContent = 'üìß Contact to Register';
                    regStatus.textContent = 'Online registration coming soon';
                } else {
                    regBtn.textContent = 'üîî Registration Opening Soon';
                    regBtn.disabled = true;
                    regStatus.textContent = 'Check back for registration details';
                }

                // Update hero CTA
                const heroCta = document.getElementById('heroCta');
                if (race.registration_url) {
                    heroCta.textContent = 'üèÉ Secure My Spot';
                    heroCta.onclick = () => window.open(race.registration_url, '_blank');
                } else if (!race.registration_open) {
                    heroCta.textContent = 'üîî Coming Soon';
                    heroCta.style.opacity = '0.7';
                }

                // === What's Included (from database) ===
                const includes = race.includes || [];
                if (includes.length > 0) {
                    const includeIcons = {
                        'shirt': 'fas fa-tshirt',
                        'tech_shirt': 'fas fa-tshirt',
                        'technical_shirt': 'fas fa-tshirt',
                        'event_tank': 'fas fa-tshirt',
                        'medal': 'fas fa-medal',
                        'bib': 'fas fa-id-badge',
                        'timing': 'fas fa-stopwatch',
                        'food': 'fas fa-utensils',
                        'post_race_party': 'fas fa-champagne-glasses',
                        'mimosas': 'fas fa-glass-cheers',
                        'beer': 'fas fa-beer-mug-empty',
                        'photos': 'fas fa-camera',
                        'bag': 'fas fa-shopping-bag',
                        'shuttle': 'fas fa-bus',
                        'cert': 'fas fa-certificate',
                        'parking': 'fas fa-parking',
                        'body_marking': 'fas fa-marker',
                        'transition_area': 'fas fa-arrows-alt'
                    };
                    const includeLabels = {
                        'shirt': 'Race Shirt',
                        'tech_shirt': 'Technical Shirt',
                        'technical_shirt': 'Technical Shirt',
                        'event_tank': 'Event Tank',
                        'medal': 'Finisher Medal',
                        'bib': 'Race Bib',
                        'timing': 'Chip Timing',
                        'food': 'Post-Race Food',
                        'post_race_party': 'Post-Race Party',
                        'mimosas': 'Mimosas & Treats',
                        'beer': 'Post-Race Beer',
                        'photos': 'Free Race Photos',
                        'bag': 'Swag Bag',
                        'shuttle': 'Shuttle Service',
                        'cert': 'Finisher Certificate',
                        'parking': 'Included Parking',
                        'body_marking': 'Body Marking',
                        'transition_area': 'Transition Area'
                    };

                    document.getElementById('includedList').innerHTML = includes.map(item =>
                        `<li><i class="${includeIcons[item] || 'fas fa-check'}"></i> ${includeLabels[item] || item}</li>`
                    ).join('');
                    document.getElementById('includedSection').style.display = 'block';
                }

                // === YouTube Video ===
                if (race.youtube_url) {
                    const videoId = extractYouTubeId(race.youtube_url);
                    if (videoId) {
                        document.getElementById('youtubeEmbed').src = `https://www.youtube.com/embed/${videoId}`;
                        document.getElementById('videoSection').style.display = 'block';
                    }
                }

                // === Course Details ===
                let courseHtml = '';
                if (race.terrain) courseHtml += `<p><strong>üõ§Ô∏è Terrain:</strong> ${race.terrain.charAt(0).toUpperCase() + race.terrain.slice(1)}</p>`;
                if (race.elevation) courseHtml += `<p><strong>üìà Elevation Gain:</strong> ${race.elevation}</p>`;
                if (courseHtml) {
                    document.getElementById('courseDetails').innerHTML = courseHtml;
                    document.getElementById('courseSection').style.display = 'block';
                }

                // === Logistics ===
                let hasLogistics = false;
                if (race.aid_stations) {
                    document.getElementById('aidInfo').textContent = race.aid_stations;
                    document.getElementById('aidSection').style.display = 'block';
                    hasLogistics = true;
                }
                if (race.parking) {
                    document.getElementById('parkingInfo').textContent = race.parking;
                    document.getElementById('parkingSection').style.display = 'block';
                    hasLogistics = true;
                }
                if (race.packet_pickup && race.packet_pickup.length > 0) {
                    // packet_pickup is an array of location objects from the API
                    const pickupSummary = race.packet_pickup.map(loc => {
                        const date = new Date(loc.pickup_date + 'T00:00:00');
                        const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                        return `${loc.location_name} (${dateStr})`;
                    }).join(' ‚Ä¢ ');
                    document.getElementById('packetInfo').textContent = pickupSummary;
                    document.getElementById('packetSection').style.display = 'block';
                    hasLogistics = true;
                }

                if (hasLogistics) {
                    document.getElementById('logisticsSection').style.display = 'block';
                }

                // === Charity ===
                if (race.charity_name) {
                    document.getElementById('charityName').textContent = race.charity_name;
                    if (race.charity_description) {
                        document.getElementById('charityDesc').textContent = race.charity_description;
                    }
                    if (race.charity_percent) {
                        document.getElementById('charityDesc').textContent += ` (${race.charity_percent}% of proceeds donated)`;
                    }
                    document.getElementById('charitySection').style.display = 'block';
                }

                // === Logo ===
                if (race.logo_url) {
                    document.getElementById('raceLogo').src = race.logo_url;
                    document.getElementById('raceLogoContainer').style.display = 'block';
                }

                // === Gallery ===
                const gallery = race.gallery_images || [];
                if (gallery.length > 0) {
                    document.getElementById('galleryGrid').innerHTML = gallery.map(imgUrl =>
                        `<div style="aspect-ratio: 1; overflow: hidden; border-radius: 8px; cursor: pointer;" onclick="window.open('${imgUrl}', '_blank')">
                            <img src="${imgUrl}" alt="Gallery Image" style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1.0)'">
                        </div>`
                    ).join('');
                    document.getElementById('gallerySection').style.display = 'block';
                }

                // ========================================
                // ACCORDION SECTIONS (NEW)
                // ========================================

                // === Packet Pickup ===
                if (race.packet_pickup && race.packet_pickup.length > 0) {
                    const pickupHtml = race.packet_pickup.map(loc => {
                        const date = new Date(loc.pickup_date + 'T00:00:00');
                        const day = date.getDate();
                        const month = date.toLocaleDateString('en-US', { month: 'short' });
                        return `
                            <div class="pickup-card">
                                <div class="pickup-date">
                                    <div class="day">${day}</div>
                                    <div class="month">${month}</div>
                                </div>
                                <div>
                                    <strong>${loc.location_name}</strong>
                                    <p style="font-size: 0.9rem; color: #666; margin-top: 4px;">${loc.address}${loc.city ? ', ' + loc.city : ''}</p>
                                    <p style="font-size: 0.85rem; color: #888; margin-top: 4px;">${formatTime(loc.start_time)} - ${formatTime(loc.end_time)}</p>
                                    ${loc.is_race_day ? '<span style="background: var(--primary); color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; margin-top: 4px; display: inline-block;">Race Day</span>' : ''}
                                    ${loc.notes ? `<p style="font-size: 0.85rem; color: #666; margin-top: 6px; font-style: italic;">${loc.notes}</p>` : ''}
                                </div>
                            </div>
                        `;
                    }).join('');
                    document.getElementById('pickupContent').innerHTML = pickupHtml;
                    document.getElementById('pickupAccordion').style.display = 'block';
                }

                // === FAQs ===
                if (race.faqs && race.faqs.length > 0) {
                    const faqHtml = race.faqs.map((faq, index) => `
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${faq.question}</span>
                                <i class="fas fa-plus"></i>
                            </div>
                            <div class="faq-answer">${faq.answer}</div>
                        </div>
                    `).join('');
                    document.getElementById('faqContent').innerHTML = faqHtml;
                    document.getElementById('faqAccordion').style.display = 'block';
                }

                // === Policies ===
                if (race.policies && race.policies.length > 0) {
                    const policyLabels = {
                        'headphone_policy': 'üéß Headphones',
                        'dog_policy': 'üêï Dogs',
                        'stroller_policy': 'üë∂ Strollers',
                        'bag_check': 'üéí Bag Check',
                        'shirt_swap': 'üëï Shirt Swap'
                    };
                    const policiesHtml = race.policies.map(p => `
                        <div class="content-card">
                            <h4>${policyLabels[p.policy_type] || p.policy_type}</h4>
                            <p>${p.policy_text}</p>
                        </div>
                    `).join('');
                    document.getElementById('policiesContent').innerHTML = policiesHtml;
                    document.getElementById('policiesAccordion').style.display = 'block';
                }

                // === Awards & Age Groups ===
                if (race.award_categories && race.award_categories.length > 0) {
                    const ageGroups = race.award_categories.filter(a => a.category_type === 'age_group');
                    const specialAwards = race.award_categories.filter(a => a.category_type !== 'age_group');

                    let html = '';
                    if (ageGroups.length > 0) {
                        html += `<h4 style="margin-bottom: 12px; font-size: 0.95rem;">Age Groups</h4>
                        <div class="award-tags">${ageGroups.map(a => `<span class="award-tag">${a.category_name}</span>`).join('')}</div>`;
                    }
                    if (specialAwards.length > 0) {
                        html += `<h4 style="margin: 20px 0 12px; font-size: 0.95rem;">Special Categories</h4>
                        <div class="award-tags">${specialAwards.map(a => `<span class="award-tag" style="background: #fef3c7; border-left: 3px solid #f59e0b;">${a.category_name}</span>`).join('')}</div>`;
                    }

                    // Course Records
                    if (race.course_records && race.course_records.length > 0) {
                        html += `<h4 style="margin: 20px 0 12px; font-size: 0.95rem;">üèÜ Course Records</h4>`;
                        html += race.course_records.map(r => `
                            <div style="display: flex; gap: 20px; margin-bottom: 8px;">
                                <span style="font-weight: 600; text-transform: capitalize;">${r.gender}:</span>
                                <span>${r.record_holder_name}</span>
                                <span style="color: var(--primary); font-weight: 700;">${r.finish_time}</span>
                                <span style="color: #888;">(${r.record_year})</span>
                            </div>
                        `).join('');
                    }

                    document.getElementById('awardsContent').innerHTML = html;
                    document.getElementById('awardsAccordion').style.display = 'block';
                }

                // === Travel & Accommodations ===
                const content = race.content || {};
                const hasTravel = content.nearest_airport || (race.accommodations && race.accommodations.length > 0);
                if (hasTravel) {
                    let travelHtml = '';
                    if (content.nearest_airport) {
                        travelHtml += `<div class="content-card"><h4>‚úàÔ∏è Nearest Airport</h4><p>${content.nearest_airport}${content.airport_distance ? ' (' + content.airport_distance + ')' : ''}</p></div>`;
                    }
                    if (race.accommodations && race.accommodations.length > 0) {
                        travelHtml += `<h4 style="margin: 16px 0 12px;">üè® Hotels</h4>`;
                        travelHtml += race.accommodations.map(h => `
                            <div class="content-card">
                                <h4>${h.hotel_name}</h4>
                                ${h.discount_description ? `<p style="color: var(--primary); font-weight: 600;">${h.discount_description}</p>` : ''}
                                ${h.website_url ? `<a href="${h.website_url}" target="_blank" style="color: var(--primary); font-size: 0.9rem;">Visit Website ‚Üí</a>` : ''}
                            </div>
                        `).join('');
                    }
                    document.getElementById('travelContent').innerHTML = travelHtml;
                    document.getElementById('travelAccordion').style.display = 'block';
                }

                // === Spectator Locations ===
                if (race.spectator_locations && race.spectator_locations.length > 0) {
                    const spectatorHtml = race.spectator_locations.map(loc => `
                        <div class="content-card">
                            <h4>üìç ${loc.location_name}</h4>
                            <p>${loc.description || ''}</p>
                            ${loc.has_parking ? '<span style="background: #d1fae5; color: #065f46; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem;">Parking Available</span>' : ''}
                        </div>
                    `).join('');
                    document.getElementById('spectatorContent').innerHTML = spectatorHtml;
                    document.getElementById('spectatorAccordion').style.display = 'block';
                }

                // === Multi-Sport Details ===
                if (race.multisport_details) {
                    const ms = race.multisport_details;
                    let msHtml = '';
                    if (ms.water_temperature_typical) msHtml += `<div class="content-card"><h4>üåä Water Temperature</h4><p>${ms.water_temperature_typical}</p></div>`;
                    if (ms.wetsuit_policy) msHtml += `<div class="content-card"><h4>üèä Wetsuit Policy</h4><p>${ms.wetsuit_policy}</p></div>`;
                    if (ms.bike_requirements) msHtml += `<div class="content-card"><h4>üö¥ Bike Requirements</h4><p>${ms.bike_requirements}</p></div>`;
                    if (ms.transition_area_notes) msHtml += `<div class="content-card"><h4>üîÑ Transition Area</h4><p>${ms.transition_area_notes}</p></div>`;
                    if (ms.relay_rules) msHtml += `<div class="content-card"><h4>üë• Relay Rules</h4><p>${ms.relay_rules}</p></div>`;
                    if (ms.usat_rules_url) msHtml += `<a href="${ms.usat_rules_url}" target="_blank" class="content-card" style="display: block; text-decoration: none;"><h4>üìã USAT Rules</h4><p style="color: var(--primary);">View Official Rules ‚Üí</p></a>`;

                    if (msHtml) {
                        document.getElementById('multisportContent').innerHTML = msHtml;
                        document.getElementById('multisportAccordion').style.display = 'block';
                    }
                }

                // Video Highlights
                if (race.youtube_video_url) {
                    const url = race.youtube_video_url;
                    let videoId = '';
                    if (url.includes('v=')) {
                        videoId = url.split('v=')[1].split('&')[0];
                    } else if (url.includes('youtu.be/')) {
                        videoId = url.split('youtu.be/')[1].split('?')[0];
                    }

                    if (videoId) {
                        document.getElementById('videoFrame').src = `https://www.youtube.com/embed/${videoId}`;
                        document.getElementById('videoSection').style.display = 'block';
                    }
                }

                // === Beneficiaries (Always Visible) ===
                if (race.beneficiaries && race.beneficiaries.length > 0) {
                    const beneficiariesHtml = race.beneficiaries.map(b => `
                        <div class="beneficiary-card">
                            <h4>‚ù§Ô∏è ${b.organization_name}</h4>
                            ${b.description ? `<p>${b.description}</p>` : ''}
                            ${b.website_url ? `<a href="${b.website_url}" target="_blank" style="color: #78350f; font-weight: 600; margin-top: 8px; display: inline-block;">Learn More ‚Üí</a>` : ''}
                        </div>
                    `).join('');
                    document.getElementById('beneficiariesList').innerHTML = beneficiariesHtml;
                    document.getElementById('beneficiariesSection').style.display = 'block';
                }

                // === Sponsors (Always Visible) ===
                if (race.sponsors && race.sponsors.length > 0) {
                    // Group by type
                    const exclusive = race.sponsors.filter(s => s.sponsor_type === 'exclusive_partner');
                    const partners = race.sponsors.filter(s => s.sponsor_type === 'partner');
                    const sponsors = race.sponsors.filter(s => s.sponsor_type === 'sponsor');

                    let sponsorHtml = '';
                    if (exclusive.length > 0) {
                        sponsorHtml += `<h4 style="margin-bottom: 12px; color: #f59e0b;">‚≠ê Exclusive Partners</h4>`;
                        sponsorHtml += `<div class="sponsor-grid">${exclusive.map(s => `
                            <a href="${s.website_url || '#'}" target="_blank" class="sponsor-logo" title="${s.organization_name}">
                                ${s.logo_url ? `<img src="${s.logo_url}" alt="${s.organization_name}">` : `<span style="font-weight: 600; text-align: center;">${s.organization_name}</span>`}
                            </a>
                        `).join('')}</div>`;
                    }
                    if (partners.length > 0) {
                        sponsorHtml += `<h4 style="margin: 20px 0 12px;">ü§ù Partners</h4>`;
                        sponsorHtml += `<div class="sponsor-grid">${partners.map(s => `
                            <a href="${s.website_url || '#'}" target="_blank" class="sponsor-logo" title="${s.organization_name}">
                                ${s.logo_url ? `<img src="${s.logo_url}" alt="${s.organization_name}">` : `<span style="font-weight: 600; text-align: center;">${s.organization_name}</span>`}
                            </a>
                        `).join('')}</div>`;
                    }
                    if (sponsors.length > 0) {
                        sponsorHtml += `<h4 style="margin: 20px 0 12px;">Sponsors</h4>`;
                        sponsorHtml += `<div class="sponsor-grid">${sponsors.map(s => `
                            <a href="${s.website_url || '#'}" target="_blank" class="sponsor-logo" title="${s.organization_name}">
                                ${s.logo_url ? `<img src="${s.logo_url}" alt="${s.organization_name}">` : `<span style="font-weight: 600; text-align: center; font-size: 0.8rem;">${s.organization_name}</span>`}
                            </a>
                        `).join('')}</div>`;
                    }

                    document.getElementById('sponsorsList').innerHTML = sponsorHtml;
                    document.getElementById('sponsorsSection').style.display = 'block';
                }

                // Hide loading, show content
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';

            } catch (error) {
                console.error('Error loading race:', error);
                document.getElementById('loadingState').innerHTML = `
                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #e74c3c; margin-bottom: 20px;"></i>
                <h2>Race Not Found</h2>
                <p style="color: #666; margin: 15px 0;">This race may have been removed or the link is incorrect.</p>
                <p><a href="../events.html" style="color: var(--primary); font-weight: 600;">‚Üê Back to All Events</a></p>
            `;
            }
        }

        // Accordion Toggle Function
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const isOpen = content.classList.contains('show');

            // Close all others
            document.querySelectorAll('.accordion-content').forEach(c => c.classList.remove('show'));
            document.querySelectorAll('.accordion-header').forEach(h => h.classList.remove('active'));

            // Toggle current
            if (!isOpen) {
                content.classList.add('show');
                header.classList.add('active');
            }
        }

        // FAQ Toggle Function
        function toggleFaq(question) {
            const answer = question.nextElementSibling;
            const icon = question.querySelector('i');
            const isOpen = answer.classList.contains('show');

            if (isOpen) {
                answer.classList.remove('show');
                icon.className = 'fas fa-plus';
            } else {
                answer.classList.add('show');
                icon.className = 'fas fa-minus';
            }
        }

        // Load on page load
        document.addEventListener('DOMContentLoaded', loadRace);
    </script>

</body>

</html>